{"pageProps":{"post":{"attributes":{},"html":"<h2 id=\"projectcard-component\">ProjectCard Component</h2>\n<p>Next, the project card. Create <code>/components/ProjectCard.tsx</code></p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">import</span> { <span class=\"hljs-variable constant_\">FC</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;react&quot;</span>;\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">Prisma</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;@prisma/client&quot;</span>;\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Card</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;./Card&quot;</span>;\n<span class=\"hljs-keyword\">import</span> clsx <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;clsx&quot;</span>;\n\n<span class=\"hljs-keyword\">const</span> projectWithTasks = <span class=\"hljs-title class_\">Prisma</span>.<span class=\"hljs-property\">validator</span>&lt;<span class=\"hljs-title class_\">Prisma</span>.<span class=\"hljs-property\">ProjectArgs</span>&gt;()({\n  <span class=\"hljs-attr\">include</span>: { <span class=\"hljs-attr\">tasks</span>: <span class=\"hljs-literal\">true</span> },\n});\n\ntype <span class=\"hljs-title class_\">ProjectWithTasks</span> = <span class=\"hljs-title class_\">Prisma</span>.<span class=\"hljs-property\">ProjectGetPayload</span>&lt;<span class=\"hljs-keyword\">typeof</span> projectWithTasks&gt;;\n\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">formatDate</span> = (<span class=\"hljs-params\">date</span>) =&gt;\n  <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Date</span>(date).<span class=\"hljs-title function_\">toLocaleDateString</span>(<span class=\"hljs-string\">&quot;en-us&quot;</span>, {\n    <span class=\"hljs-attr\">weekday</span>: <span class=\"hljs-string\">&quot;long&quot;</span>,\n    <span class=\"hljs-attr\">year</span>: <span class=\"hljs-string\">&quot;numeric&quot;</span>,\n    <span class=\"hljs-attr\">month</span>: <span class=\"hljs-string\">&quot;short&quot;</span>,\n    <span class=\"hljs-attr\">day</span>: <span class=\"hljs-string\">&quot;numeric&quot;</span>,\n  });\n\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">ProjectCard</span>: <span class=\"hljs-variable constant_\">FC</span>&lt;{ <span class=\"hljs-attr\">project</span>: <span class=\"hljs-title class_\">ProjectWithTasks</span> }&gt; = <span class=\"hljs-function\">(<span class=\"hljs-params\">{ project }</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">const</span> completedCount = project.<span class=\"hljs-property\">tasks</span>.<span class=\"hljs-title function_\">filter</span>(\n    <span class=\"hljs-function\">(<span class=\"hljs-params\">t</span>) =&gt;</span> t.<span class=\"hljs-property\">status</span> === <span class=\"hljs-string\">&quot;COMPLETED&quot;</span>\n  ).<span class=\"hljs-property\">length</span>;\n  <span class=\"hljs-keyword\">const</span> progress = <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">ceil</span>((completedCount / project.<span class=\"hljs-property\">tasks</span>.<span class=\"hljs-property\">length</span>) * <span class=\"hljs-number\">100</span>);\n\n  <span class=\"hljs-keyword\">return</span> (\n    <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Card</span> <span class=\"hljs-attr\">className</span>=<span class=\"hljs-string\">&quot;!px-6 !py-8 hover:scale-105 transition-all ease-in-out duration-200&quot;</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span> <span class=\"hljs-attr\">className</span>=<span class=\"hljs-string\">&quot;text-sm text-gray-300&quot;</span>&gt;</span>\n          {formatDate(project.createdAt)}\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">className</span>=<span class=\"hljs-string\">&quot;mb-6&quot;</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span> <span class=\"hljs-attr\">className</span>=<span class=\"hljs-string\">&quot;text-3xl text-gray-600&quot;</span>&gt;</span>{project.name}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">className</span>=<span class=\"hljs-string\">&quot;mb-2&quot;</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span> <span class=\"hljs-attr\">className</span>=<span class=\"hljs-string\">&quot;text-gray-400&quot;</span>&gt;</span>\n          {completedCount}/{project.tasks.length} completed\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">className</span>=<span class=\"hljs-string\">&quot;w-full h-2 bg-violet-200 rounded-full mb-2&quot;</span>&gt;</span>\n          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>\n            <span class=\"hljs-attr\">className</span>=<span class=\"hljs-string\">{clsx(</span>\n              &quot;<span class=\"hljs-attr\">h-full</span> <span class=\"hljs-attr\">text-center</span> <span class=\"hljs-attr\">text-xs</span> <span class=\"hljs-attr\">text-white</span> <span class=\"hljs-attr\">bg-violet-600</span> <span class=\"hljs-attr\">rounded-full</span>&quot;\n            )}\n            <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">{{</span> <span class=\"hljs-attr\">width:</span> `${<span class=\"hljs-attr\">progress</span>}%` }}\n          &gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">className</span>=<span class=\"hljs-string\">&quot;text-right&quot;</span>&gt;</span>\n          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span> <span class=\"hljs-attr\">className</span>=<span class=\"hljs-string\">&quot;text-sm text-gray-600 font-semibold&quot;</span>&gt;</span>\n            {progress}%\n          <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Card</span>&gt;</span></span>\n  );\n};\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-title class_\">ProjectCard</span>;\n</code></pre>\n<h2 id=\"getting-project-data\">Getting Project Data</h2>\n<p>We then need to get projects on the home page.</p>\n<pre><code class=\"hljs language-ts\"><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">getData</span> = <span class=\"hljs-keyword\">async</span> (<span class=\"hljs-params\"></span>) =&gt; {\n  <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">delay</span>(<span class=\"hljs-number\">2000</span>);\n  <span class=\"hljs-keyword\">const</span> user = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">getUserFromCookie</span>(<span class=\"hljs-title function_\">cookies</span>());\n  <span class=\"hljs-keyword\">const</span> projects = <span class=\"hljs-keyword\">await</span> db.<span class=\"hljs-property\">project</span>.<span class=\"hljs-title function_\">findMany</span>({\n    <span class=\"hljs-attr\">where</span>: {\n      <span class=\"hljs-attr\">ownerId</span>: user.<span class=\"hljs-property\">id</span>,\n    },\n    <span class=\"hljs-attr\">include</span>: {\n      <span class=\"hljs-attr\">tasks</span>: <span class=\"hljs-literal\">true</span>,\n    },\n  });\n\n  <span class=\"hljs-keyword\">return</span> { projects };\n};\n</code></pre>\n<p>We can now call <code>getData</code> in the page component and loop over the projects to create project cards.</p>\n<pre><code class=\"hljs language-ts\"><span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">Page</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">const</span> { projects } = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">getData</span>();\n\n  <span class=\"hljs-comment\">//.....</span>\n  {\n    projects.<span class=\"hljs-title function_\">map</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">project</span>) =&gt;</span> (\n      <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">className</span>=<span class=\"hljs-string\">&quot;w-1/3 p-3&quot;</span> <span class=\"hljs-attr\">key</span>=<span class=\"hljs-string\">{project.id}</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">Link</span> <span class=\"hljs-attr\">href</span>=<span class=\"hljs-string\">{</span>`/<span class=\"hljs-attr\">project</span>/${<span class=\"hljs-attr\">project.id</span>}`}&gt;</span>\n          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">ProjectCard</span> <span class=\"hljs-attr\">project</span>=<span class=\"hljs-string\">{project}</span> /&gt;</span>\n        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">Link</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span></span>\n    ));\n  }\n}\n</code></pre>\n<h2 id=\"fix-the-seed-script\">Fix The Seed Script</h2>\n<p>The original seed script never hashed the password so you won&#39;t be able to log in with the seeded user. To fix this, make sure your seed script hashes the password:</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-comment\">// in prisma/seed.ts</span>\n<span class=\"hljs-attr\">create</span>: {\n<span class=\"hljs-comment\">// ...</span>\n  <span class=\"hljs-attr\">password</span>: <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">hashPassword</span>(<span class=\"hljs-string\">&quot;password&quot;</span>),\n<span class=\"hljs-comment\">// ...</span>\n}\n</code></pre>\n<h2 id=\"delete-data-and-reseed-database\">Delete Data and Reseed Database</h2>\n<p>The seed script uses an upsert which won&#39;t update the current user. Reset the database and reseed the data:</p>\n<pre><code class=\"hljs language-bash\">npx prisma migrate reset\n</code></pre>\n<blockquote>\n<p>✔️ Code Checkpoint: The current code for the application can be found on the <a href=\"https://github.com/Hendrixer/fullstack-app-v2-app/tree/project-card\">project-card branch</a>.</p>\n</blockquote>\n","slug":"project-card","title":"Project Card","section":"Dashboard Home","icon":"columns","filePath":"/home/runner/work/fullstack-v2-instructions/fullstack-v2-instructions/lessons/08-dashboard-home/D-project-card.md","nextSlug":"/lessons/dashboard-home/task-card","prevSlug":"/lessons/dashboard-home/greetings-skeleton"}},"__N_SSG":true}