{"pageProps":{"post":{"attributes":{},"html":"<h2 id=\"passwords\">Passwords</h2>\n<p>Before we can create the API routes to handle user auth, we need some utility functions.</p>\n<p>Create a new file, <code>auth</code> in the <code>lib</code> folder and add this code. These functions will help us hash and check passwords.</p>\n<pre><code class=\"hljs language-ts\"><span class=\"hljs-keyword\">import</span> bcrypt <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;bcrypt&quot;</span>;\n<span class=\"hljs-keyword\">import</span> { <span class=\"hljs-title class_\">SignJWT</span>, jwtVerify } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;jose&quot;</span>;\n<span class=\"hljs-keyword\">import</span> { db } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;./db&quot;</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">hashPassword</span> = (<span class=\"hljs-params\">password</span>) =&gt; bcrypt.<span class=\"hljs-title function_\">hash</span>(password, <span class=\"hljs-number\">10</span>);\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">comparePasswords</span> = (<span class=\"hljs-params\">plainTextPassword, hashedPassword</span>) =&gt;\n  bcrypt.<span class=\"hljs-title function_\">compare</span>(plainTextPassword, hashedPassword);\n</code></pre>\n<p><strong>Note:</strong> If you are adding types to your code, you&#39;ll need to install @types/bcrypt:</p>\n<pre><code class=\"hljs language-bash\">`npm i -D @types/bcrypt`\n</code></pre>\n<p>This file might be imported by a server component so we&#39;ll tell Next.js about the dependencies In the <code>next.config.js</code> we&#39;ll add <code>bcrypt</code>:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-attr\">experimental</span>: {\n  <span class=\"hljs-attr\">appDir</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">serverComponentsExternalPackages</span>: [<span class=\"hljs-string\">&#x27;bcrypt&#x27;</span>],\n},\n</code></pre>\n","slug":"passwords","title":"Passwords","section":"Auth","icon":"lock","filePath":"/home/runner/work/fullstack-v2-instructions/fullstack-v2-instructions/lessons/07-auth/C-passwords.md","nextSlug":"/lessons/auth/jwt","prevSlug":"/lessons/auth/pages"}},"__N_SSG":true}